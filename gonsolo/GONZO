# Use the Makefile!
# This file is mostly obsolete.

MESON = meson
# MESON = ~/src/meson/meson.py

# List mesa configuration options:
$(MESON) configure

# Configure mesa (in root dir):
# Intel and zink
$(MESON) setup gonzo-intel-zink -Dbackend=ninja -Dintel-clc=enabled -Dvulkan-drivers=intel -Dgallium-drivers=iris,zink,swrast -Dprefix=~/bin/mesa
# Nouveau and nvk and borg
$(MESON) setup gonzo-nouveau-borg -Dbackend=ninja -Dgallium-drivers= -Dvulkan-drivers=nouveau-experimental,borg-experimental -Dprefix=~/bin/mesa
# Panfrost
$(MESON) setup gonzo-panfrost -Dbackend=ninja -Dvulkan-drivers=help -Dprefix=~/bin/mesa

# Build
cd gonzo-*; meson compile

# Get rid of unknown options for SLP
sed -i 's/-mtls-dialect=gnu2 //g' compile_commands.json
sed -i 's/-flifetime-dse=1 //g' compile_commands.json


# Test Vulkan Compute:
# https://github.com/gonsolo/VulkanHpp-Compute-Sample
